---
description: 流動性ステーキングプールの概要。

---

# 流動性ステーキングプール

流動性ステーキングプールにUSDCをステーキングするユーザーには2.5%\(`2,500万DYDX`\)が分配されます。

### 目的

* ブーストラップdYdXの流動性ネットワーク効果

## 概要

流動性は、特に適切に使用されることで、交換を成功させる主要なコンポーネントとなります。流動性ネットワーク効果をさらに高め、プロのマーケットメーカーにインセンティブを与えられるように、DYDXは流動性ステーキングプールへUSDCをステーキングするユーザーに対して提供されます。既知で承認済みのマーケットメーカーは、ステーキングされたUSDCを使用することでプロトコルにマーケットを構築するとともに、マーケット全体で流動性を利用できるようにします。マーケットメーカーは、USDCをプロトコルから出金することはできず、プロトコルの中でのみ使用する必要があります。ただし、マーケットメーカーが資金を失うことになり\（不採算なトレードにより\）、流動性ステーキングプールを補填できない場合は、ステーキングされたUSDCの一部が失われる可能性があります。ステーカーは、プール内にある合計USDC保有高の各ステーカーの保有割合に従って継続的に提供されるDYDXを受け取ります。ステーカーがエポック終了後にUSDCを出金できるようにするには、エポックの`14日`\（**ブラックアウトウィンドウ**\）前までにUSDCのステーキング解除をリクエストする必要があります。ステーカーが出金をリクエストしない場合、ステーキングされたUSDCは次のエポックにロールオーバーされます。

## 承認済み借入者

流動性ステーキングプールコントラクトは、両方向の無担保型の貸付システムとして運用されます。

出金できる額は、借入者の割り当て比率やプールにステーキングされている使用可能な資金総額によって異なります。割り当て比率と使用可能な資金総額はいずれも、`LS1EpochSchedule`で指定された所定の時間に変更することが可能です。借入した資金は、dYdXレイヤ2の取引でのみ使用できます。これは、L2取引コントラクト\(`StarkPerpetual`\)と連携する`TrustedBorrowerL2Proxy`コントラクトにより実施されます。

古くから承認されている流動性プロバイダーには、立ち上げ以来プロトコルで積極的にマーケットメイキングを行っている`Wintermute`、`Sixtant`、`Kronos`、`Amber`、`MGNR`が挙げられます。

| 事前承認済みの借入者 | 当初の割り当て比率 | 流動性プロバイダーに関する詳細 |
| :--- | :--- | :--- |
| Wintermute | `X％`TBD | [https://dydx.exchange/blog/ama-recap-wintermute](https://dydx.exchange/blog/ama-recap-wintermute) |
| Sixtant | Y％ TBD | [https://dydx.exchange/blog/ama-recap-sixtant](https://dydx.exchange/blog/ama-recap-sixtant) |
| Kronos \(Wootrade\) | Z％ TBD | [https://dydx.exchange/blog/ama-recap-wootrade](https://dydx.exchange/blog/ama-recap-wootrade) |
| Amber | Z％ TBD |  |
| MGNR | Z％ TBD |  |

ユーザーが資金のステーキング解除をリクエストすると、次のエポックで割り当てられる借入者の残高は、現在の借入額を下回る場合があります。この場合、借入者はエポックの終了前に、借入と割り当ての残高の差額を返済する責任があります。借入者の借入残高が次のエポックの開始時の割り当てを上回る場合、次のエポックが始まる前に差額を必ず返済してください。

借入者が資金を借り入れ返済すると、純借入残高が記録されます。すべての借入者の純借入残高総額も確認できます。コントラクトが保有する残りの残高は、未借入残高と呼ばれます。

コントラクトを全体として見る場合は、常に以下の等式に当てはまるものとします。

アクティブ総額+非アクティブ総額=借入総額+未借入総額

### ガバナンス

dYdXガバナンスでは以下の責任を有します。

* 既存の借入者に対するデューデリジェンスの実施
* ステーキングプールに借入者を新たに追加
* 承認された借入者に対する借入資金の割り当て変更
   * 特定の借入者の割り当てを変更する場合、\`setBorrowerAllocations\`および\`setBorrowingRestriction\`関数が呼び出されます。これらの関数を使用して借入者を追加および削除することができます。追加は次のエポックから適用されますが、削除による借入制限はただちに適用されることになります。ブラックアウトウィンドウの間は、これらの関数を呼び出すことはできません。
* エポックの期間やブラックアウトウィンドウは、コントラクトの作成時に設定されるものですが、dYdXガバナンスにより変更される場合もあります

### ステーキングされた残高の計算

ステーキングされた残高は、次の2つのいずれかの状態になっています。

* アクティブ：借入可能。ステーキング報酬の獲得あり。ステーカーによる出金不可。
* 非アクティブ：借入不可。報酬の獲得なし。ステーカーによる出金可能。

ステーカーによっては、アクティブな残高と非アクティブな残高の組み合わさっている場合があります。以下の例に示すように、資金はエポックごとに構成されています。

ステーキングされた残高に関する操作は次のとおりです。

* デポジット：アクティブな残高が増えます。
* 出金リクエスト：現在のエポックの終了時に、一部資金がアクティブから非アクティブに変更されます。
* 出金：非アクティブな残高が減ります。
* 移動：アクティブな資金の一部が別のステーカーに移動されます。

特定のエポックの終了時に残高が変わる予定があることをコードで表すには、各残高をcurrentEpoch、currentEpochBalance、nextEpochBalanceの3フィールド構造で保存します。また、非アクティブなユーザー残高は、shortfallCounterフィールドも使用します。

## FAQ

### ステーキング報酬を獲得するにはどうすればよいですか？

ステーカーは、流動性ステーキングプールにいつでもUSDCを入金し、即座に報酬の獲得を開始することができます。DYDXの報酬は、プール総額における各ステーカーの割り当てに従い、継続的に獲得されます。報酬の請求および出金はいつでも可能です。

### 流動性プールにUSDCを入金してステーキングするにはどうすればよいですか？

資金を入金およびステーキングするには、ユーザーは\`stake\`[関数](https://github.com/dydxprotocol/governance-private/blob/2645927b44f517f51c84e35a00a1ee810300c13f/contracts/liquidity/v1/impl/LS1Staking.sol#L59)を呼び出します。また、\`stakeFor\`[関数](https://github.com/dydxprotocol/governance-private/blob/2645927b44f517f51c84e35a00a1ee810300c13f/contracts/liquidity/v1/impl/LS1Staking.sol#L64)を呼び出して、他のアドレスに代わって入金およびステーキングすることもできます。

流動性プールにUSDCをステーキングするには、以下の手順に従います。

* 「ステーキングする」をクリックします
* 初めて入金する場合は、USDCを有効にする必要があります。この操作は1回行うだけで構いません。
* プールにステーキングするUSDCの額を入力します
* 「資金をステーキング」をクリックします。なお、資金のステーキングおよびステーキング解除を行うには、ガス手数料を支払う必要があります

![](https://lh4.googleusercontent.com/caSDz783Gi-asRNYP8Gm8L5qv_yAuJZwEmUAfl8I1MfHecIF2In10IQCqZBCIpxeXl90eT28GGLbZyts8-x9U5w4Y6LBC4kyehMEalsZu_-aI11S6V7nwPrwtcc75m2M8847jFvv)

ステーキングされた資金がアクティブになり、すぐに報酬の獲得が始まります。

### 報酬の計算

アクティブな資金による報酬は、アクティブでいる期間に対して獲得されるものです。つまり、資金の一部出金をリクエストした後でも、エポックの終了までこれらの資金により引き続き報酬を獲得することになります。例：

上記のシナリオでは、ユーザーはt\_0からt\_2までの期間に対して報酬を獲得し、その期間、報酬はステーキングされた総残高に合わせて変動します。ユーザーが残高の一部を出金リクエストするだけであれば、残りの残高によりt\_2以降も報酬を獲得し続けることができます。

### ブラックアウトウィンドウとは何ですか？

ブラックアウトウィンドウとは、ユーザーが、ステーキングされた資金の出金をリクエストすることができない期間です。ブラックアウトウィンドウの間は、\`requestWithdrawal\`関数を呼び出すことができません。これはエポックの最後の14日間として初めから設定されているものです。新しいエポックは、28日ごとに開始されます。つまり、ユーザーは所定のエポックが終了する7日前までであれば、次のエポックでの出金をリクエストすることができます。

### ステーキングプールから資金を出金するにはどうすればよいですか？どのくらいかかりますか？

出金に関してはエポックのスケジュールに合わせて行われ、これにより、プールの資金の可用性に対応した予測や一定の周期での実施が可能になります。ステーカーはエポックの終了後に出金できるように、エポック終了の少なくとも14日前までにステーキングを解除するようリクエストする必要があります。ステーカーからの出金リクエストがない場合、ステーキングされたUSDCは次のエポックにロールオーバーされます。

資金を出金するには、ユーザーは、\`requestWithdrawal\`[関数](https://github.com/dydxprotocol/governance-private/blob/master/contracts/liquidity/v1/impl/LS1Staking.sol#L73-L83)を呼び出し、次のエポックでの資金の出金をリクエストをします。現在のエポックでは、ユーザーの資金はステーキングされたままとなり、出金できません。次のエポックから資金は「非アクティブ」となり、出金が可能になります。

次のエポックで、ユーザーは\`[withdrawStake](https://github.com/dydxprotocol/governance-private/blob/master/contracts/liquidity/v1/impl/LS1Staking.sol#L91)\`関数を呼び出して、非アクティブな資金を特定のアドレスに出金します。ユーザーは、出金する非アクティブな資金の額を指定するか、\`withdrawMaxStake\`関数を呼び出して、非アクティブな資金をすべて出金することができます。eth\_callで最大値を検索して\`withdrawStake\(\)\`を呼び出すよりも、\`withdrawMaxStake\`関数の方がガス効率が低くなります。

### 流動性ステーキングプールへのステーキングにはどんなリスクがありますか？借入者が債務を返済できないとどうなりますか？

無担保ローンには極めて高い信頼度が伴い、借入者はそれを満たさなければなりません。流動性プロバイダーは、プロトコルからステーキングされたUSDCを出金することはできず、プロトコルでのみ使用する必要があります。しかし、流動性プロバイダーがトレード資金を失うことになり、外部の資金源により借入した割り当てに補填できない場合、ステーキングされたUSDCが失われる可能性があります。

こうした状況で、ショートフォールが発生して借入者が出金リクエストした資金の返済に遅延が生じた場合、非アクティブの資金は、社会化（比例配分）された損失の対象になる可能性があります。無担保ローンにおける債務不履行の場合、滞納の借入者は著しい風評被害に直面することになります。

コントラクトソルベンシー：

どんなときも、ステーキングされた残高と借入した残高の関係に基づき、コントラクトは以下のいずれかの状態になります。

| ![](https://lh3.googleusercontent.com/nTJuAC4WSmhOiAGkM6r-YWzy6z2MIHQnydr8U0n-TReAh_gfqD6ZyalxQpYv9RNBsJzrlw78QB_wp9utqBc-PQZipwzWpxDifD1_zEtyVBhYXRl_f8V-iDMwLBO70LQsftDlXrsr) | ![](https://lh3.googleusercontent.com/x_Yev8ZJrYYm8FTDSdoj0jDXEBY_b9xOC69lpQudQdoALQ_tuQFEbFc5hAU6TbpGNCB6J2BsjMwHb59GrCqR52747j45jSC_BmyzyiY72gTRk4oamv35gO8PPZalA43COZF1pgtP) |
| :--- | :--- |
| ![](https://lh6.googleusercontent.com/wX37DQoW9oR4OhJzb4hc5ZxPE1X05OPfyETbUv7WTY0b__WH2PydjJoBuQIREHgeWL18GDn7E1ORgGmcre0R6iYPmwSsdFNzBZ7DBPs0wkajjoDBjxDYDPHcet_-dPPAyS1GWL0v) |  |

コントラクトにおいて債務超過とされるのは以下の場合です。

* 借入の総残高がアクティブの総残高を上回っている
* すなわち、非アクティブの総残高が未借入の総残高を上回っている
* すなわち、出金可能な総残高がコントラクトのUSDC残高を上回っている

上記のとおりでなければ、コントラクトにおいて支払い能力ありとされます。

借入は、アクティブなUSDCのうち借入者の割り当て比率分に限られ、また非アクティブな残高は、エポック間は増加のみであるため\（「ネイキッド」USDCがコントラクトに移行される場合を除く\）、コントラクトはエポックの移行期間中に支払能力ありから債務超過の状態にしか変わらないのが一般的です。

借入者個人は、保有する割り当て残高が未払いの借入残高を下回る1週間前までに必ず通知されることになっています。このような推移が起こるのはエポック間のみです。

コントラクトが債務超過になっている間、ユーザーは保有している資金の全額を出金できなくなる場合があります。さらに、ショートフォールに対する対処可否や迅速性において少しでも不確実性があると、状況により新たなリスクがもたらされます。

1. ユーザーは、新たな資金をステーキングすることを躊躇するかもしれません。資金を回収できない状況になるかもしれないからです。
2. 資金を回収できる可能性が限りなく高くなるよう、現在ステーキングしているユーザーは「急いで出口に向かう」ようになり、なるべく早く出金しようとするかもしれません。

損失はインデックスで確認できます。ここでは、特定のショートフォールが発生したことにより債務に切り替わった非アクティブな資金を細分化したものが示されています。各ステーカーの非アクティブな残高には、キャッシュされたショートフォールのカウンターがあり、直近の残高更新時に対して過去に発生したショートフォール回数が示されています。 非アクティブな残高により発生した損失は、ステーカーの債務残高と同等のクレジットとなります。インデックスの計算方法に関する詳細については、LS1DebtAccountingを参照してください。

コントラクトが債務超過である場合、割り当てを超過している借入者を対象にしたmarkDebt\(\)関数が呼び出されます\（呼び出し者は任意\）。借入残高が割り当て残高を上回っている金額が債務残高と呼ばれます。債務残高の金額は、借入残高から未払い債務をまとめた専用残高に移動されます。

ステーキングされた資金の計算と等しくなるよう調整が行われます。債務額に相当する金額が非アクティブな残高から差し引かれ、ステーカーが有するショートフォールの債務からなる特別残高に追加されます。各ステーカーの非アクティブな残高が削減される一方で、同じ金額の債務を受け取ることになります。このようにして、非アクティブな残高を保有するすべてのステーカーにおいて、債務超過による損失が社会化\（比例配分\）されるのです。

この過程を図解すると以下のようになります。

![](https://lh5.googleusercontent.com/2b2e67wVF3DL32NU0ykTVV0PJWaJ_bdmRQRKgx-5c3_qr_nWNYsuE77JviLtbBxXzASEfIp2Fw4hvzRPeM1a7TAIxq0NYUfo3dZLUhChilDpa5Ygq-YugSvNXKmyf2ul3GQM22SZ)

債務のある借入者が債務を返済する場合\（またはガバナンスなどの他の当事者が代理で返済する場合\）、債務を有するステーカーたちは、先着順で資金を回収することができます。

### 債務は何を表していますか？

債務

### 借入者による債務不履行が発生した場合、ステーカーには償還請求権（リコース）がありますか？

借入者においてmarkDebt()が呼び出されると、借入者はコントラクトからさらなる資金を借り入れる権利を失います。この権利は、ガバナンスにより回復させることができます。

ファンデーションとのマーケットメーカー契約におけるコンテンツ追加の可能性

