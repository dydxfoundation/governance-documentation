---
description: >-
  Пошаговый обзор процесса управления, создания ЗК, создания опроса Snapshot, создания ППУ, голосования по опросу Snapshot, голосования по ППУ, постановки ППУ в очередь и исполнения ППУ.
---

# Руководство по управлению

dYdX Foundation создала это руководство, чтобы помочь сообществу dYdX понять процесс управления dYdX. В этом руководстве приводится пошаговый обзор следующих процессов:

* [Обсуждения на форуме (вне цепочки)](governance-guide.md#step-1-forum-discussions-drc-creation-off-chain-and-drc-feedback)
* [Создание ЗК (вне цепочки)](governance-guide.md#step-1-forum-discussions-drc-creation-off-chain-and-drc-feedback)
* [Создание опроса Snapshot (вне цепочки)](governance-guide.md#step-2-drc-snapshot-polling-off-chain)
* [Голосование по опросу Snapshot](governance-guide.md#how-to-vote-on-a-snapshot-poll)
* [Создание ППУ (вне цепочки)](governance-guide.md#step-3-dip-creation-off-chain-proposal)
* [Создание ППУ (в цепочке)](governance-guide.md#step-1-on-chain-dip-drafting)
* [Голосование по ППУ (в цепочке)](governance-guide.md#how-to-vote-on-a-dip)
* [Постановка ППУ в очередь (в цепочке)](governance-guide.md#how-to-queue-a-proposal)
* [Исполнение ППУ (в цепочке)](governance-guide.md#how-to-execute-a-proposal)

В руководстве представлены два примера: _ППУ 2 (предложение вне цепочки) — сокращение порогового значения объема, необходимого для получения награды для поставщиков ликвидности_; _ППУ 3 (предложение в цепочке) — восстановление модуля безопасности_.

## ППУ 2 (предложение вне цепочки) — сокращение порогового значения объема, необходимого для получения награды для поставщиков ликвидности

_**Краткий обзор:**_

В эпоху 6 сообщество dYdX проголосовало на [Snapshot](https://commonwealth.im/dydx/snapshot/dydxgov.eth/0x785066561be1e5d170eb28960da5ef2643ee0d0c3d590fd797c028512cc6be43) за сокращение порогового значения объема наград для поставщиков ликвидности, присуждаемых маркетмейкерам, с 1% до 0,25%. Сокращение порогового значения объема наград для поставщиков ликвидности с 5% до 1% в эпоху 2 происходило тем же образом, что и в эпоху 6 (с 1% до 0,25%). Ниже приведен пошаговый обзор процесса сокращения порогового значения объема наград для поставщиков ликвидности с 5% до 1%.

Большинство участников сообщества (399 голосующих, владеющих 86% токенов $ethDYDX) проголосовали на [Snapshot](https://forums.dydx.community/snapshot/dydxgov.eth/QmXtS7CGVX7C5v2JdcJpsqWAeZrStQcogSQpP6zzhzwLmN) за сокращение порогового объема, необходимого для получения награды для поставщиков ликвидности, с 5% до 1%. [ППУ вне цепочки](https://github.com/dydxfoundation/dip/blob/master/content/dips/DIP-2.md) по сокращению порогового значения объема, необходимого маркетмейкерам для получения наград для поставщиков ликвидности, с 5% до 1% внес Джейкоб Гох (jteam0x) из DeFiance Capital. Маркетмейкеры, достигшие порогового значения объема в 1% в эпоху 2, смогли получить награду для поставщиков ликвидности в эпоху 3. Это предложение не требовало внесения изменений в смарт-контракт в цепочке.

_**Справочная информация:**_

Согласно [программе вознаграждения](https://docs.dydx.community/dydx-governance/rewards/liquidity-provider-rewards) поставщиков ликвидности, 1 150 685 $ethDYDX распределяются каждую эпоху (28 дней) между поставщиками ликвидности, которые поддерживают двусторонние котировки на рынке в рамках протокола. Награды распределяются по формуле, учитывающей сочетание времени работы, двусторонней глубины, спредов между курсами покупателей и продавцов, а также количества поддерживаемых рынков. Чтобы получить право на участие в этой программе вознаграждения, поставщики ликвидности должны иметь минимальный процент от общего объема торговли мейкеров за предыдущую эпоху.

Сообщество dYdX обладает оперативным и безотзывным контролем над пороговым значением объема, необходимого для получения наград для поставщиков ликвидности. Полный список параметров, которые контролирует сообщество, можно найти [здесь](https://docs.dydx.community/dydx-governance/voting-and-governance/governance-parameters).

Сообщество было заинтересовано в снижении порогового значения объема, необходимого для получения наград для поставщиков ликвидности, поскольку это стимулировало бы новых маркетмейкеров, а также маркетмейкеров малого и среднего размера к повышению ликвидности на платформе dYdX. Кроме того, чем больше маркетмейкеров на платформе, тем более децентрализованным становится протокол dYdX.

Далее мы представим пошаговый обзор того, как управление dYdX функционирует на практике. Более подробную информацию о процессе управления dYdX можно найти [здесь](https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle).

### **ЭТАП 1 — обсуждения на форуме, создание ЗК (вне цепочки) и отзывы о ЗК**

_**Описание:**_

Процесс управления dYdX осуществляется на [форумах управления](https://dydx.forum/). Участники сообщества размещают сообщения и комментарии в ветках обсуждения, чтобы достичь приблизительного консенсуса вне цепочки. Более подробную информацию об обсуждениях на форуме и создании ЗК можно найти [здесь](https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle). \
\
Примечание. Операционная служба subDAO запустила [**https://dydx.forum/**](https://dydx.forum/) в качестве новой площадки для форумов после того, как [сообщество проголосовало за переход с Commonwealth на Discourse](https://snapshot.org/#/dydxgov.eth/proposal/0xa5e77732dd24edd26bd41b089969b3662c29eb41c3bacd35cb2931ca55882a8f). В этом руководстве некоторые ссылки на предыдущие обсуждения ЗК по-прежнему ведут на Commonwealth, однако все новые обсуждения должны проходить на новом форуме [**Discourse**](https://dydx.forum/). \


_**На примере ППУ 2:**_

Су Чжу (zhusu) из Three Arrows Capital создал [обсуждение на форуме вне цепочки](https://forums.dydx.community/proposal/discussion/1805-reduce-market-maker-incentives/), чтобы сократить пороговое значение объема, необходимого для получения награды для поставщиков ликвидности. Различные участники сообщества, такие как Евгений из Wintermute, Бен из Kronos, Джош из Sixtant и многие другие, приняли участие в обсуждении и предоставили полезные отзывы.

![https://forums.dydx.community/proposal/discussion/1805-reduce-market-maker-incentives/](../.gitbook/assets/2-reduce-mm-incentives.png)

![https://forums.dydx.community/proposal/discussion/1805-reduce-market-maker-incentives/](../.gitbook/assets/2-reduce-mm-incentives-2.png)

#### _Как разместить публикацию и комментарии в Discourse:_

* Зарегистрируйтесь в Discourse с помощью своего адреса электронной почты и присоединитесь к сообществу dYdX [здесь](https://dydx.forum/).

<figure><img src="../.gitbook/assets/Screenshot 2023-04-19 at 10.59.27 AM.png" alt=""><figcaption></figcaption></figure>

* После выбора беседы вы можете пролистывать комментарии, ставить отметку «Нравится» или отвечать на комментарии.
* Создайте новую беседу или опубликуйте ЗК, нажав **«Новая беседа»** и выбрав категорию темы.

<figure><img src="../.gitbook/assets/Screenshot 2023-04-19 at 11.03.33 AM.png" alt=""><figcaption></figcaption></figure>

* Если вы создаете ЗК, следуйте шаблону, приведенному [здесь](https://github.com/dydxfoundation/dip/blob/master/DIP-X.md). Как описано в разделе _Создание ЗК_ в статье [Жизненный цикл предложения](https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle), ЗК должны включать в себя как минимум следующее:
  * Краткое и лаконичное название ЗК.
  * Краткое и лаконичное описание предложения.
  * Обоснование ЗК (например, причина его создания).
  * Название публикации на форуме должно выглядеть следующим образом: ЗК: \[вставьте краткое название ЗК] (например, «ЗК: запрос на новый рынок»).
  * Опрос сообщества, который его участники могут использовать для офчейн-голосования по улучшениям.

### **ЭТАП 2 — опрос Snapshot по ЗК (вне цепочки)**

_**Описание:**_

После того как сообщество достигнет приблизительного консенсуса, любой его участник, владеющий правом на внесение предложений и 10 000 DYDX, может создать офчейн-голосование по ЗК на [Snapshot](https://snapshot.org/#/). [Право на внесение предложений](https://docs.dydx.community/dydx-governance/voting-and-governance/voting) позволяет создавать и поддерживать предложения. Snapshot — это простой интерфейс для голосования, который позволяет пользователям выразить мнение вне блокчейна. Голоса на Snapshot взвешиваются по количеству токенов управления, которые хранятся на адресе, используемом для голосования, или делегированы на него. Участник сообщества, создающий опрос Snapshot, должен предоставить подробную информацию о ЗК, системе голосования, дате начала и окончания голосования, а также номере блока Snapshot. Период голосования должен составлять 5 дней, а голосование должно начаться после задержки голосования в 1 день (_из расчета 13,2 секунды на блок)_. Задержка голосования дает время участникам сообщества dYdX на то, чтобы узнать больше о ЗК, приобрести $ethDYDX или делегировать право голоса своих токенов управления. Право голоса имеют члены сообщества, которые владеют токенами управления или которым было делегировано право голоса до номера блока Snapshot. Более подробную информацию об опросе Snapshot можно найти [здесь](https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle).

_**На примере ППУ 2:**_

Участники сообщества предоставили отзывы о публикации Су Чжу. Они предложили следующие пороговые значения объема, необходимые для получения награды:

* [0,5%](https://forums.dydx.community/proposal/discussion/1805-reduce-market-maker-incentives?comment=body) — Су Чжу из Three Arrows Capital;
* [1%](https://forums.dydx.community/proposal/discussion/1805-reduce-market-maker-incentives?comment=4972) — Сэм из BitTrading;
* [2,5%](https://forums.dydx.community/proposal/discussion/1805-reduce-market-maker-incentives?comment=4855) — Бен из Kronos / WOO Network;
* [5%](https://forums.dydx.community/proposal/discussion/1805-reduce-market-maker-incentives?comment=4872) — Евгений из Wintermute.

Затем Су Чжу создал опрос Snapshot со следующими вариантами:

* Сокращение порогового значения для маркетмейкеров до 1%
* Сокращение порогового значения для маркетмейкеров до 2,5%
* Сохранение порогового значения для маркетмейкеров на уровне 5%

![https://snapshot.org/#/dydxgov.eth/proposal/QmXtS7CGVX7C5v2JdcJpsqWAeZrStQcogSQpP6zzhzwLmN](../.gitbook/assets/2-create-snapshot.png)

#### _Как проголосовать в опросе Snapshot:_

* Зарегистрируйтесь на Snapshot, используя свой кошелек Ethereum, и следите за предложениями dYdX [здесь](https://snapshot.org/#/dydxgov.eth).

![https://snapshot.org/#/dydxgov.eth](../.gitbook/assets/2-register-snapshot.png)

* Для участия в голосовании по активным опросам Snapshot необходимо владеть токенами управления или иметь право голоса, делегированное вашему адресу до достижения номера блока Snapshot, когда опрос Snapshot становится активным.
* Чтобы проголосовать, нажмите на предложение, выберите «Голосовать», а затем — «Да» или «Нет».

#### _Как создать опрос на Snapshot:_

* Чтобы создать опрос Snapshot, вы должны **владеть минимум 10 000 токенов управления** **и/или иметь право на внесение предложений, делегированное адресу, который вы используете** для создания предложения.
* Предложение Snapshot может состоять из одного или нескольких действий (до 10). Действия — это изменения, указанные в предложении.
* Если вы владеете как минимум 10 000 DYDX, выберите **«Новое предложение»** и заполните открытые поля в соответствии с приведенными ниже требованиями к содержимому.

<figure><img src="../.gitbook/assets/Screenshot 2023-04-19 at 11.08.42 AM.png" alt=""><figcaption><p>Страница Snapshot dYdX — кнопка создания нового предложения</p></figcaption></figure>

<figure><img src="../.gitbook/assets/Screenshot 2023-04-19 at 11.09.33 AM.png" alt=""><figcaption><p>Укажите здесь подробную информацию о Snapshot и обязательно укажите ссылку на ЗК</p></figcaption></figure>

Требования к содержимому опроса Snapshot по ЗК:

* сведения о ЗК со ссылкой на обсуждение на форуме;
* система голосования;
* дата начала и окончания голосования составляют в общей сложности 4 дня (_из расчета 13,2 секунды на блок)_;
* опрос Snapshot публикуется за 1 день (\примерно 6570 блоков) до начала голосования.

Требование к опросам Snapshot, имеющим обязательную силу:

В отношении большинства решений опрос Snapshot несет информационную цель, в то время как для обязывающего результата, изменяющего смарт-контракты, требуется голосование в цепочке. Для решений, которые не требуют вызова смарт-контракта в цепочке, например, изменения формул распределения наград за торговлю или для поставщиков ликвидности, голосование Snapshot имеет обязательную и окончательную силу. В дополнение к вышеуказанным требованиям к содержимому опросы Snapshot, связывающие голоса для переменных, контролируемых вне цепочки, должны включать в себя следующее:

* Бинарные варианты голосования. Для ясности, адрес голосует либо за предложение, либо против него.

![](../.gitbook/assets/2-snapshot-binary-voting.png)

* После голосования соответствующая информация будет сохранена в IPFS, а отчет будет автоматически сформирован и доступен для загрузки.

![https://snapshot.org/#/dydxgov.eth/proposal/QmXtS7CGVX7C5v2JdcJpsqWAeZrStQcogSQpP6zzhzwLmN](../.gitbook/assets/2-snapshot-ipfs.png)

### **ЭТАП 3 — создание ППУ (предложение вне цепочки)**

_**Описание**:_

ППУ необходимо создавать, когда (1) опрос Snapshot приводит к изменению какого-либо параметра вне цепочки (например, изменение формул распределения наград за торговлю или для поставщиков ликвидности) и (2) когда участник сообщества хочет представить предложение по изменению смарт-контрактов в цепочке. Для голосований, которые не требуют изменения смарт-контракта в цепочке, результат опроса Snapshot должен быть закреплен в ППУ вне цепочки и представлен с помощью запроса на внесение изменений в ветке dYdX Foundation на GitHub, где рассматривается это ППУ. ППУ должен содержать победный результат опроса Snapshot. В ППУ должна быть указана информация, включенная в шаблон, который расположен [здесь](https://github.com/dydxfoundation/dip/blob/master/DIP-X.md).

_**На примере ППУ 2:**_

В этом случае автором [ППУ](https://github.com/jteamdc/dip/blob/master/content/dips/DIP-2.md) выступил @Jteamdc.

![https://github.com/jteamdc/dip/blob/master/content/dips/DIP-2.md](../.gitbook/assets/2-dip-example.png)

Когда проект предложения для ППУ 2 был завершен, @Jteamdc создал [запрос на внесение изменений](https://github.com/dydxfoundation/dip/pull/8) \*\*\*\* из рабочей ветки в отношении ветки ожидающих рассмотрения ППУ dYdX Foundation. После того как dYdX Foundation рассмотрела предложение и подписала его, изменения в ветке, где рассматривается ППУ, были включены в основную ветку.

![https://github.com/dydxfoundation/dip/pulls](../.gitbook/assets/2-dip-pending-merge.png)

Поскольку снижение порогового значения объема, необходимого для получения награды для поставщиков ликвидности, не требует внесения изменений в смарт-контракты в цепочке, то процесс завершен, и изменения вступят в силу в следующую эпоху.

#### _Как создать ППУ:_

* ППУ должно быть основано на победном результате офчейн-голосования по ППУ на Snapshot. Оно может состоять из одного или нескольких действий (до десяти). Действия — это изменения, указанные в предложении. Более подробную информацию можно найти в разделе [Создание ППУ](https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle#6.-proposal-queuing-and-execution).
* Зарегистрируйтесь и создайте учетную запись GitHub: [https://github.com/signup](https://github.com/signup).
* Перейдите на страницу репозитория dYdX [здесь](https://github.com/dydxfoundation/dip) и дублируйте репозиторий в своей учетной записи GitHub.

![https://github.com/dydxfoundation/dip](../.gitbook/assets/2-dip-create-1.png)

* В дублированном репозитории ППУ перейдите в каталог с содержимым ППУ: [https://github.com/\[user\_name\]/dip/tree/master/content/dips](https://github.com/yt8073/dip/tree/master/content/dips).

![](../.gitbook/assets/2-dip-create-2.png)

* Выберите папку с ППУ: [https://github.com/\[user\_name\]/dip/tree/master/content](https://github.com/Jwatts15/dip/tree/master/content).

![](../.gitbook/assets/2-dip-create-3.png)

Папка с ППУ содержит каталог предыдущих предложений, которые соответствуют шаблону ППУ, приведенному [здесь.](https://github.com/dydxfoundation/DIP/blob/master/DIP-X.md)

![https://github.com/dydxfoundation/dip/tree/master/content/dips](../.gitbook/assets/2-dip-create-4.png)

* Прежде чем начать составление предложения, убедитесь, что ветка, которую вы дублировали, соответствует последней версии основной ветки. Если вы используете старую версию репозитория ППУ, убедитесь, что дублированная версия содержит последние изменения. Чтобы узнать, как переместить дублированную версию, вы можете выполнить действия, указанные здесь: [https://stackoverflow.com/questions/7929369/how-to-rebase-local-branch-onto-remote-master](https://stackoverflow.com/questions/7929369/how-to-rebase-local-branch-onto-remote-master).
* Измените [шаблон ППУ](https://github.com/dydxfoundation/DIP/blob/master/DIP-X.md), внеся информацию о вашем предложении. Если вы не дублировали репозиторий ППУ, выберите значок изменения. При этом репозиторий будет автоматически дублирован из основной ветки, поскольку вы не являетесь администратором.

![https://github.com/dydxfoundation/DIP/blob/master/DIP-X.md](../.gitbook/assets/2-dip-create-5.png)

* Следуйте [шаблону](https://github.com/dydxfoundation/DIP/blob/master/DIP-X.md) и добавьте ППУ в дублированный репозиторий в каталог `content/dips/`. Следуйте приведенным ниже правилам обозначения статусов ППУ.

![](../.gitbook/assets/2-dip-create-6.png)

Статусы ППУ:

* В разработке — ППУ все еще разрабатывается.
* Предложено — ППУ готово к предложению в цепочке.
* Одобрено — сообщество dYdX приняло ППУ для его реализации.
* Реализовано — ППУ был внедрено в основную сеть.
* Отклонено — ППУ отклонено.
* Проверьте правильность содержимого, создайте запрос на внесение изменений в вашей рабочей ветке и включите его в ветку dYdX Foundation, где рассматривается ППУ. Просьба **не** создавать этот запрос на внесение изменений в основной ветке dYdX Foundation, так как это приведет к сбою в работе IPFS, если какие-либо внешние стороны захотят включить свои изменения в основную ветку. Используйте запрос на внесение изменений, приведенный [здесь](https://github.com/dydxfoundation/dip/pull/8) в качестве примера.

![](../.gitbook/assets/2-dip-status-1.png)

* После проверки dYdX Foundation включит изменения из ветки, где рассматривается ППУ, в основную ветку.

![https://github.com/dydxfoundation/dip/pull/9](../.gitbook/assets/2-dip-status-2.png)

* Перед **объединением** будет автоматически запущено задание по загрузке ППУ в IPFS. Проверить загрузку ППУ в IPFS можно здесь: [https://github.com/dydxfoundation/dip/pull/9/checks](https://github.com/dydxfoundation/dip/pull/9/checks).
* ППУ добавляется в каталог [**`dip`**](https://github.com/dydxfoundation/dip)`/`[`content`](https://github.com/dydxfoundation/dip/tree/master/content)`/`**`dips`**`/`.

![](../.gitbook/assets/2-dip-status-3.png)

Поскольку предложение не требует внесения изменений в смарт-контракты в цепочке, то процесс завершен, и изменения вступят в силу в течение следующей эпохи.

## ППУ 3 (предложение в цепочке) — восстановление модуля безопасности

_**Краткий обзор:**_

1 ноября Дэн Робинсон из Paradigm создал [ППУ](https://dydx.community/dashboard/proposal/3) в цепочке для восстановления работы пула стейкинга модуля безопасности. Большая часть сообщества (251 участник, владеющий почти 142 млн ethDYDX) проголосовала за восстановление работы модуля безопасности. После 10-дневного периода голосования потребовалось почти 3 дня, чтобы один из участников сообщества вызвал функцию постановки в очередь и инициировал 7-дневную задержку блокировки по времени. 20 ноября модуль безопасности был восстановлен и сброшен до чистого состояния.

_**Справочная информация:**_

Модуль безопасности dYdX — это контракт стейкинга. Он предназначен для создания децентрализованного пула средств, которые можно использовать для поддержки протокола dYdX. Пользователи размещают $ethDYDX в пуле безопасности и получают $stkDYDX (1:1). $stkDYDX — это токенизированная позиция, переданная в качестве ERC-20, которая обладает такими же правами голоса и предложения, как и $ethDYDX. В случае дефицита управление должно провести голосование, чтобы сократить количество $ethDYDX для уменьшения потерь. 2,5% (25 000 000 $ethDYDX) из общего количества токенов, находящихся в обращении, будут распределены между пользователями, которые внесли ethDYDX в пул стейкинга безопасности. Более подробную информацию о пуле стейкинга безопасности можно найти [здесь](https://dydx.foundation/blog/en/safety-staking).

В рамках распределения [наград за стейкинг в пуле безопасности](https://docs.dydx.community/dydx-governance/staking-pools/safety-staking-pool) каждую эпоху (28 дней) между стейкерами будет распределяться 383 562 $ethDYDX. Награды распределяются между стейкерами пропорционально каждую секунду.

Сообщество dYdX имеет оперативный и безотзывный контроль над параметрами смарт-контракта модуля безопасности. Полный список параметров, которые контролирует сообщество, можно найти [здесь](https://docs.dydx.community/dydx-governance/voting-and-governance/governance-parameters).

8 сентября в 15:00 по времени в формате UTC ограничение на перевод токенов $ethDYDX было снято, что фактически открыло стейкинг в модуле безопасности dYdX. В течение почти 1 часа более 50 различных адресов внесли в стейкинг примерно 157 тысяч ethDYDX. Из-за ошибки в процессе развертывания адресам, разместившим токены в стейкинге модуля безопасности, не были выданы stkDYDX. В результате средства этих стейкеров были заблокированы в контракте, а специалисты dYdX отключили возможность стейкинга в пользовательском интерфейсе управления dYdX.

В рамках [ППУ 1](https://dydx.community/dashboard/proposal/0) было предложено восстановить работу модуля безопасности, чтобы позволить пострадавшим адресам вернуть свои средства и получить дополнительно 10% от токенов, размещенных в стейке, в качестве компенсации для возмещения ущерба. Несмотря на то, что сообщество активно поддерживало [ППУ 1 «Восстановление модуля безопасности и возмещение стейкерам»](https://dydx.community/dashboard/proposal/0), предложение не было принято, так как не набрало минимального кворума в 100 млн $ethDYDX, необходимого для принятия решения о длительной блокировке по времени. В результате Джейкоб Гох (jteam0x) из DeFiance Capital создал [ППУ 4 «Возмещение и компенсация стейкерам в рамках модуля безопасности»](https://dydx.community/dashboard/proposal/2), чтобы возместить и компенсировать пострадавшим адресам средства за упущенные награды и причиненные неудобства. [ППУ 4](https://dydx.community/dashboard/proposal/2) предусматривало развертывание контракта на восстановление для пользователей, разместивших токены в стейке, и компенсацию пострадавшим адресам дополнительных 10% из казны наград. Управление этим ППУ осуществлялось в соответствии с менее строгими параметрами управления короткой блокировки по времени.

В целом жизненный цикл ППУ последователен до момента его создания. Основное отличие ППУ 3 (в цепочке) от ППУ 2 (вне цепочки) заключалось в том, что первое предложение требовало проведения голосования и развертывания смарт-контрактов в цепочке. Поскольку процесс обсуждения на форуме, создания ЗК и создания проекта ППУ одинаков, мы начнем наше пошаговое обсуждение с требований к содержимому проекта ППУ в цепочке. Более подробную информацию можно найти по ссылкам ниже:

* Процесс управления dYdX: [https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle](https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle).
* Отчет об инциденте с модулем безопасности: [https://dydx.foundation/blog/en/outage-1](https://dydx.foundation/blog/en/outage-1).
* Обсуждение на форуме вне цепочки**:** [https://commonwealth.im/dydx/proposal/discussion/1743-safety-staking-pool-on-pause](https://commonwealth.im/dydx/proposal/discussion/1743-safety-staking-pool-on-pause).
* ЗК вне цепочки**:** [https://commonwealth.im/dydx/proposal/discussion/1770-drc-incident-report-of-the-safety-module-outage-proposed-solution](https://commonwealth.im/dydx/proposal/discussion/1770-drc-incident-report-of-the-safety-module-outage-proposed-solution).
* Опрос Snapshot по ЗК вне цепочки**:** [https://snapshot.org/#/dydxgov.eth/proposal/QmbJ5QxHr1pyShKTDaF5DjAr6vxQn8DVxshH2fyWgzDCBn](https://snapshot.org/#/dydxgov.eth/proposal/QmbJ5QxHr1pyShKTDaF5DjAr6vxQn8DVxshH2fyWgzDCBn).
* ППУ, предложенное на GitHub**:** [https://github.com/dydxfoundation/dip/blob/master/content/dips/DIP-3.md](https://github.com/dydxfoundation/dip/blob/master/content/dips/DIP-3.md).

### **ЭТАП 1 — разработка проекта ППУ в цепочке**

_**Описание:**_

Разработка проекта ППУ в цепочке, влияющего на консенсус управления протокола dYdX, должна осуществляться в соответствии с конкретными шагами по внесению изменений в смарт-контракты. После того как сообщество достигает приблизительного консенсуса на основе опроса Snapshot или по предыдущему неудачному ППУ, любой участник сообщества, обладающий достаточным правом на внесение предложений, может представить новое ППУ в цепочке. Более подробную информацию о пороговом значении права на внесение предложений, исполнителе с правом на короткую блокировку по времени и других параметрах управления можно найти [здесь](https://docs.dydx.community/dydx-governance/voting-and-governance/governance-parameters).

_**На примере ППУ 3:**_

В этом случае автором [ППУ](https://github.com/dydxfoundation/dip/blob/master/content/dips/DIP-3.md) был Дэн Робинсон из Paradigm. С учетом того что предложение подразумевало внесение изменений в смарт-контракты в цепочке, в него была включена ссылка на конкретные реализации смарт-контрактов.

![https://github.com/dydxfoundation/dip/blob/master/content/dips/DIP-3.md](../.gitbook/assets/2-dip3-example-1.png)

После перехода от контракта развертывания SafetyModuleV2.sol к папке Safety можно увидеть файл README, содержащий конкретные сведения о реализации предложения.

![](../.gitbook/assets/2-dip3-example-1a.png)

Действия по реализации предложения, включенные в README, приведены здесь: [https://github.com/dydxfoundation/governance-contracts/tree/master/contracts/safety](https://github.com/dydxfoundation/governance-contracts/tree/master/contracts/safety).

![https://github.com/dydxfoundation/governance-contracts/tree/master/contracts/safety](../.gitbook/assets/2-dip3-example-2.png)

![https://github.com/dydxfoundation/governance-contracts/tree/master/contracts/safety](../.gitbook/assets/2-dip3-example-3.png)

![https://github.com/dydxfoundation/governance-contracts/tree/master/contracts/safety](../.gitbook/assets/2-dip3-example-4.png)

#### _Как разработать проект ППУ в цепочке (со статусом «В разработке»)_

* Создайте новый кошелек для разработки ППУ. В процессе развертывания потребуется ввести вашу сид-фразу в качестве переменной окружения, поэтому для создания ППУ в цепочке мы рекомендуем использовать одноразовый кошелек.
* Для разработки ППУ делегируйте одноразовому кошельку достаточно прав на внесение предложений. Делегировать право на внесение предложений можно [здесь](https://dydx.community/dashboard). Различные пороговые значения для права на внесение предложений приведены [здесь](https://docs.dydx.community/dydx-governance/voting-and-governance/governance-parameters).
  * Короткая блокировка по времени: 0,5% от общего количества токенов в обращении (5 млн для права на внесение предложений).
  * Исполнитель Starkware: 0,5% от общего количества токенов в обращении (5 млн для права на внесение предложений).
  * Исполнитель с правом на длительную блокировку по времени: 2,0% от общего количества токенов в обращении (20 млн для права на внесение предложений).
  * Исполнитель с правом на остановку дерева Меркла: 0,5% от общего количества токенов в обращении (5 млн для права на внесение предложений).
* Создайте ключ Alchemy. Благодаря ключу Alchemy вам не нужно запускать узел Ethereum для взаимодействия с Ethereum и развертывания смарт-контракта. Руководство по созданию ключа Alchemy приведено [здесь](https://docs.alchemy.com/alchemy/introduction/getting-started).

![https://docs.alchemy.com/alchemy/introduction/getting-started](../.gitbook/assets/2-draft-dip-example-1.png)

Выберите Ethereum и нажмите «Начать работу».

![](../.gitbook/assets/2-draft-dip-example-2.png)

Заполните необходимую информацию, выберите сеть Goerli и нажмите «Создать приложение».

<figure><img src="../.gitbook/assets/2-draft-dip-example-3.png" alt=""><figcaption></figcaption></figure>

После создания учетной записи следуйте указаниям по настройке, приведенным [здесь](https://docs.alchemy.com/alchemy/introduction/getting-started).

В разделе «4. Начало создания» выберите «Попробовать развернуть свой первый смарт-контракт» и следуйте указаниям.

![https://docs.alchemy.com/alchemy/introduction/getting-started](../.gitbook/assets/2-draft-dip-example-4.png)

* Откройте командную строку Windows, приложение терминала по умолчанию, или скачайте iTerm: [https://iterm2.com/](https://iterm2.com/).
* Скачайте и установите Node.js и npm, если вы еще не сделали этого: [https://docs.npmjs.com/downloading-and-installing-node-js-and-npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm).
* Hardhat — это инструмент разработки для компиляции и тестирования программного обеспечения Ethereum. Установите Hardhat, если вы еще не сделали этого: [https://hardhat.org/tutorial/setting-up-the-environment.html](https://hardhat.org/tutorial/setting-up-the-environment.html).
* Составьте проект предлагаемых вами реализаций смарт-контрактов.
* Хэш IPFS генерируется автоматически. Его можно получить [здесь](https://github.com/dydxfoundation/dip/tree/master/content/ipfs-dips). Хэш IPFS будет находиться в каталоге dYdX Foundation под именем файла `ЗК-[Новый ЗК #]-ipfs-hashes.json`.

![https://github.com/dydxfoundation/dip/tree/master/content/ipfs-dips](../.gitbook/assets/2-draft-dip-example-5.png)

* Выберите новый файл (`ППУ-[Новое ППУ #]-ipfs-hashes.jso`) и используйте encodedHash.

![https://github.com/dydxfoundation/dip/blob/master/content/ipfs-dips/DIP-3-Ipfs-hashes.json](../.gitbook/assets/2-draft-dip-example-6.png)

### **ЭТАП 2 — отправка ППУ в цепочке**

_**Описание:**_

После того как участник сообщества подтвердит правильность предложенных реализаций смарт-контрактов и ППУ будет окончательно утверждено, его можно представлять в цепочке. Когда создается ППУ в цепочке, предложение переходит в состояние ожидания для задержки голосования, которая длится примерно 1 день (около 6570 блоков). Пользовательские снимки записываются после задержки голосования для учета количества $ethDYDX, находящихся во владении, а также делегированного права голоса. Затем предложение переходит в активное состояние, а продолжительность голосования варьируется от 2 до 10 дней в зависимости от типа предложения. Для реализации предложения при голосовании должны быть достигнуты минимальный размер кворума и минимальная разница в количестве голосов. Эти параметры меняются в зависимости от типа предложения. Если ППУ удовлетворяет требованиям к минимальному размеру кворума и минимальной разнице в количестве голосов, а большинство участников сообщества с правом голоса голосуют за ППУ, любой адрес может вызвать функцию постановки в очередь, чтобы разместить предложение в очереди блокировки по времени. Контракты блокировки по времени могут ставить в очередь, отменять или исполнять операции, за которые проголосовало сообщество dYdX. Длина очереди блокировки по времени зависит от типа предложения.

_**На примере ППУ 3:**_

Специалисты Paradigm окончательно доработали код Solidity для `SafetyModuleV2.sol.`

![https://github.com/dydxfoundation/governance-contracts/blob/master/contracts/safety/v2/SafetyModuleV2.sol](../.gitbook/assets/2-draft-dip-example-7.png)

Специалисты Paradigm смоделировали обновления как в локальной версии основной сети, так и в форке основной сети. Затем был выполнен ряд тестов, чтобы убедиться, что после реализации предложения по управлению в основной сети будет восстановлена полная функциональность.

Специалисты Paradigm развернули обновления смарт-контракта, выполнив приведенные ниже сценарии.

**Развертывание восстановления модуля безопасности**

`export ALCHEMY_KEY=<... >`

`export MNEMONIC=<... >`

`npx hardhat --network mainnet deploy:safety-module-recovery`\
`--dydx-token-address 0x92D6C1e31e14520e676a687F0a93788B716BEff5`\
`--short-timelock-address 0x64c7d40c07EFAbec2AafdC243bF59eaF2195c6dc`\
`--rewards-treasury-address 0x639192D54431F8c816368D3FB4107Bc168d0E871`

**Предложение по управлению: исправление модуля безопасности**

`export ALCHEMY_KEY=<... >`

`export MNEMONIC=<... >`

`npx hardhat --network mainnet deploy:safety-module-fix-proposal`\
`--proposal-ipfs-hash-hex 0x...`\
`--governor-address 0x7E9B1672616FF6D6629Ef2879419aaE79A9018D2`\
`--long-timelock-address 0xEcaE9BF44A21d00E2350a42127A377Bf5856d84B`\
`--safety-module-address 0x65f7BA4Ec257AF7c55fd5854E5f6356bBd0fb8EC`\
`--safety-module-proxy-admin-address 0x6aaD0BCfbD91963Cf2c8FB042091fd411FB05b3C`\
`--safety-module-new-impl-address 0x...`

**Предложение по управлению: компенсация за модуль безопасности**

`export ALCHEMY_KEY=<... >`

`export MNEMONIC=<... >`

`npx hardhat --network mainnet deploy:safety-module-compensation-proposal`\
`--proposal-ipfs-hash-hex 0x...`\
`--dydx-token-address 0x92D6C1e31e14520e676a687F0a93788B716BEff5`\
`--governor-address 0x7E9B1672616FF6D6629Ef2879419aaE79A9018D2`\
`--short-timelock-address 0x64c7d40c07EFAbec2AafdC243bF59eaF2195c6dc`\
`--rewards-treasury-address 0x639192D54431F8c816368D3FB4107Bc168d0E871`\
`--safety-module-recovery-address 0x...`

ППУ было одновременно опубликовано на [https://dydx.community/dashboard](https://dydx.community/dashboard).

![https://dydx.community/dashboard](../.gitbook/assets/2-draft-dip-example-8.png)

![https://dydx.community/dashboard](../.gitbook/assets/2-draft-dip-example-9.png)

Контракт на управление dYdX 0x7e9b1672616ff6d6629ef2879419aa9018d2: [https://etherscan.io/txs?a=0x7e9b1672616ff6d6629ef2879419aae79a9018d2\&p=10](https://etherscan.io/txs?a=0x7e9b1672616ff6d6629ef2879419aae79a9018d2\&p=10).

Развертывание ППУ можно подтвердить на Etherscan: [https://etherscan.io/tx/0x5f2472e7dfcbf50628d29c94f97a072f3c19177f66cde4cca9f376c7934af5ad](https://etherscan.io/tx/0x5f2472e7dfcbf50628d29c94f97a072f3c19177f66cde4cca9f376c7934af5ad).

ППУ было создано 1 ноября 2021 года при блоке 13532376. В течение 6570 будущих блоков ППУ находилось в состоянии ожидания.

![https://etherscan.io/tx/0x5f2472e7dfcbf50628d29c94f97a072f3c19177f66cde4cca9f376c7934af5ad](../.gitbook/assets/2-draft-dip-example-10.png)

Владельцы ethDYDX смогли проголосовать по ППУ после его перехода в активное состояние на момент блока 13538946.

Первый голос был отдан 2 ноября 2021 года в 17:51:22 по времени в формате UTC (блок 13538959) через 6583 блока с момента создания ППУ в цепочке.

![https://etherscan.io/tx/0xc3d0ace92be4ac3da40dc17f45a573d4dbd83d31f7a95733071de883ded67a4f](../.gitbook/assets/2-draft-dip-example-11.png)

По истечении 10-дневного периода голосования, связанного с длительной блокировкой по времени, любой участник сообщества может вызвать функцию постановки в очередь и инициировать 7-дневную задержку блокировки по времени. Потребовалось почти 3 дня, чтобы один из участников сообщества вызвал функцию постановки ППУ 3 в очередь.

![https://etherscan.io/tx/0x3402372aa549d2270a6b5d4f84884ae2bfec6922fc808703b47d53b27d288c81](../.gitbook/assets/2-draft-dip-example-12.png)

После 7-дневной задержки блокировки по времени ППУ было реализовано в цепочке.

![https://etherscan.io/tx/0xfd332147899fd3ef1db62f262ffae92bbd7d18a5ed4e142eb0407a173dbf0453](../.gitbook/assets/2-draft-dip-example-13.png)

В момент реализации ППУ в цепочке статус предложения по адресу [https://dydx.community/dashboard/proposal/3](https://dydx.community/dashboard/proposal/3) изменился на «Исполнено».

![](../.gitbook/assets/2-draft-dip-example-14.png)

Обращаем внимание, что (1) предложения должны быть исполнены в течение 7-дневного периода исполнения, который начинается сразу после задержки блокировки по времени, и (2) адрес, выдвинувший предложение, должен сохранять минимальное право на внесение предложений (либо 5 млн, либо 20 млн DYDX) до исполнения ППУ, что требуется соответствующим контрактом блокировки по времени.

#### _Как отправить ППУ в цепочке:_

* Убедитесь, что вы обладаете достаточным правом на внесение предложений для создания ППУ. Более подробную информацию об этом можно найти в разделе [Создание ППУ](https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle).
  * Исполнитель с правом на короткую блокировку по времени: 0,5% от общего количества токенов в обращении (5 млн для права на внесение предложений).
  * Исполнитель Starkware: 0,5% от общего количества токенов в обращении (5 млн для права на внесение предложений).
  * Исполнитель с правом на длительную блокировку по времени: 2,0% от общего количества токенов в обращении (20 млн для права на внесение предложений).
  * Исполнитель с правом на остановку дерева Меркла: 0,5% от общего количества токенов в обращении (5 млн для права на внесение предложений).
* Убедитесь, что в кошельке есть ETH для уплаты комиссии за газ.
* Создайте приложение на Alchemy для основной сети Ethereum.

![https://dashboard.alchemyapi.io/](../.gitbook/assets/2-draft-dip-example-15.png)

* После создания приложения нажмите «Посмотреть ключ», чтобы получить ключ Alchemy (7LOaQtguSm2kSEcFXQH88B): [https://eth-mainnet.alchemyapi.io/v2/7LOaQtguSm2kSEcFXQH88B-EN\_K7t\_ul](https://eth-mainnet.alchemyapi.io/v2/7LOaQtguSm2kSEcFXQH88B-EN\_K7t\_ul).

![https://dashboard.alchemyapi.io/apps/xogmjmlex8tlmr95](../.gitbook/assets/2-draft-dip-example-16.png)

* Скачайте и установите Node.js и npm: [https://docs.npmjs.com/downloading-and-installing-node-js-and-npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm).
* Установите Hardhat: [https://hardhat.org/tutorial/setting-up-the-environment.html](https://hardhat.org/tutorial/setting-up-the-environment.html).
* Запустите разработанный сценарий.
* Проверьте контракт управления, чтобы убедиться, что предложение было создано в цепочке: [https://etherscan.io/txs?a=0x7e9b1672616ff6d6629ef2879419aae79a9018d2\&p=10](https://etherscan.io/txs?a=0x7e9b1672616ff6d6629ef2879419aae79a9018d2\&p=10).
* Адрес, который выдвинул предложение, должен сохранять минимальное право на внесение предложений до исполнения предложения, что требуется соответствующим контрактом блокировки по времени.

#### _Как проголосовать по ППУ:_

* Убедитесь, что в кошельке есть ETH для уплаты комиссии за газ.
* Вы можете проголосовать по активному ППУ, выбрав один из них по ссылке [https://dydx.community/dashboard](https://dydx.community/dashboard).

![](../.gitbook/assets/2-draft-dip-example-17.png)

Продолжительность голосования зависит от типа предложения. Более подробную информацию можно найти в разделе [Создание ППУ](https://docs.dydx.community/dydx-governance/voting-and-governance/dip-proposal-lifecycle).

* Исполнитель с правом на короткую блокировку по времени: 4 дня.
* Исполнитель Starkware: 4 дня.
* Исполнитель с правом на длительную блокировку по времени: 10 дней.
* Исполнитель с правом на остановку дерева Меркла: 2 дня.

#### _Как поставить предложение в очередь:_

Одобренное предложение можно поставить в очередь, чтобы начать задержку блокировки по времени.

* Для этого нужно использовать совместимый кошелек, содержащий ETH.
* Перейдите на вкладку «Контракт» на Etherscan и нажмите «Написать контракт». Контракт управления приведен [здесь](https://etherscan.io/address/0x7e9b1672616ff6d6629ef2879419aae79a9018d2#writeContract).

![https://etherscan.io/address/0x7e9b1672616ff6d6629ef2879419aae79a9018d2#writeContract](../.gitbook/assets/2-draft-dip-example-queue-1.png)

* Выберите очередь и отправьте proposalId.

![](../.gitbook/assets/2-draft-dip-example-queue-2.png)

proposalId можно найти на Etherscan после создания ППУ: [https://etherscan.io/tx/0x5f2472e7dfcbf50628d29c94f97a072f3c19177f66cde4cca9f376c7934af5ad](https://etherscan.io/tx/0x5f2472e7dfcbf50628d29c94f97a072f3c19177f66cde4cca9f376c7934af5ad).

* Выберите «Нажмите, чтобы получить дополнительные сведения».

![https://etherscan.io/tx/0x5f2472e7dfcbf50628d29c94f97a072f3c19177f66cde4cca9f376c7934af5ad](../.gitbook/assets/2-draft-dip-example-queue-3.png)

* Выберите «Декодировать входные данные».

![https://etherscan.io/tx/0x5f2472e7dfcbf50628d29c94f97a072f3c19177f66cde4cca9f376c7934af5ad](../.gitbook/assets/2-draft-dip-example-queue-4.png)

![https://etherscan.io/tx/0x5f2472e7dfcbf50628d29c94f97a072f3c19177f66cde4cca9f376c7934af5ad](../.gitbook/assets/2-draft-dip-example-queue-5.png)

#### _Как исполнить предложение:_

Одобренное предложение можно исполнить после задержки блокировки по времени.

* Перейдите на вкладку «Контракт» на Etherscan и нажмите «Написать контракт». Контракт управления приведен [здесь](https://etherscan.io/address/0x7e9b1672616ff6d6629ef2879419aae79a9018d2#writeContract).

![https://etherscan.io/address/0x7e9b1672616ff6d6629ef2879419aae79a9018d2#writeContract](../.gitbook/assets/2-draft-dip-example-execute-1.png)

* Выберите «Исполнить» и отправьте proposalId.

![https://etherscan.io/address/0x7e9b1672616ff6d6629ef2879419aae79a9018d2#writeContract](../.gitbook/assets/2-draft-dip-example-execute-2.png)

* Чтобы найти proposalId, выполните действия, указанные выше в разделе _Как поставить предложение в очередь_.
* В поле payableAmount (ether) введите 0.
