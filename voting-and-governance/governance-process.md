---
description: Высокоуровневый обзор архитектуры управления.
---

# Архитектура

## Обзор

$ethDYDX, $stkDYDX и $wethDYDX («Токены управления») предоставляют владельцам право вносить предложения и голосовать по изменениям в dYdX v3. Управление dYdX основывается на контрактах управления AAVE, и поддерживает голосование на основе количества токенов управления.

Предложения должны получить определенное число и процент положительных голосов, что зависит от типа предложения.

Право на голосование и поддержку токенов управления позволяет владельцу токенов управления вносить предложения и голосовать по предложениям управления. Обратите внимание, что владелец токенов управления может делегировать такие полномочия другим адресам Ethereum.

В основе управления dYdx лежат 8 смарт-контрактов:

* **Контракты на `токены $ethDYDX, $stkDYDX и $wethDYDX`** имеют снимки права голоса каждого адреса в разных блоках по времени.
* **Контракт на `стратегию управления V2`** содержит логическую схему оценки относительного права пользователей на внесение предложений и голосование. Сообщество dYdX [проголосовало](https://dydx.community/dashboard/proposal/15) за обновление контракта на `стратегию управления` до `стратегии управления V2`, чтобы предоставить $wethDYDX ту же функциональность управления, что и ethDYDX, для голосования и внесения предложений в управление dYdX v3.
* **Контракт на `модуль безопасности`** содержит логическую схему стейкинга токенов $ethDYDX, токенизирует позицию и позволяет получать награды. Токен, размещенный в стейке модуля безопасности, сохраняет полные права управления.
* **Контракт `управляющего`**: отслеживает и может исполнять предложения с помощью смарт-контракта на блокировку по времени.
* **Контракт на `блокировку по времени`**: может помещать в очередь, отменять или выполнять операции, за которые проголосовало управление. Функции в предложении инициируются контрактом на блокировку по времени. Операции, находящиеся в очереди, могут исполняться с задержкой и до окончания льготного периода.
* **Контракт `на приоритетную блокировку по времени`**: аналогичен контракту на блокировку по времени, но позволяет контролеру приоритета исполнять операции в течение **периода приоритета** (7 дней) до окончания задержки блокировки по времени.

![Архитектура смарт-контрактов](../.gitbook/assets/1-smart-contract-architectue.png)

Ончейн-управление dYdX позволяет следующее:

* Голосовать по предложениям, которые должны быть исполнены любым авторизованным контрактом исполнителя
* Получать снимки находящихся во владении токенов в начале процесса внесения предложения
* Делегирование отдельных прав на внесение предложений и прав голоса
* Устанавливать пороговые значения управления, в том числе для предложений, кворумов и разницы в количестве голосов
* Менять способ подсчета голосов (путем замены адреса смарт-контракта на стратегию управления адресом контракта управляющего)

## Типы предложений

Существует четыре типа предложений с разными параметрами, которые влияют на их срок действия и исполнение. Так, критически важные предложения, влияющие на консенсус управления, требуют больше времени для голосования и большей разницы в количестве голосов, а предложения, влияющие только на параметры протокола, требуют меньше времени и могут быть исполнены быстро. Исполнитель должен подтвердить каждый тип предложения.

#### **Исполнитель с правом на короткую блокировку по времени**

Исполнитель с правом на короткую блокировку по времени контролирует следующее:

* Поощрительные контракты, включая модуль ликвидности, модуль безопасности и модуль дистрибьютора Меркла
* Средства в казне наград и сообщества
* Создание новых токенов
* Все контракты доверенности за исключением модуля безопасности
* Попечительство для контрактов доверенности Stark

**Исполнитель Starkware с правом на приоритетную блокировку по времени**

Исполнитель Starkware с правом на приоритетную блокировку по времени владеет контрактом StarkEx Perpetual Exchange. Он может выполнять предложения, которые контролируют конфигурацию dYdX v3.

При необходимости для правильного осуществления изменений на бирже может потребоваться участие специалистов Starkware. Поэтому данный исполнитель наделен полномочиями приоритетного контролера, предоставляющего специалистам Starkware период в 7 дней (**период приоритета**), в течение которого только они могут инициировать выполнение предложения.

Starkware не контролирует то, _какие_ изменения вносятся в протокол. Только владельцы токенов $ethDYDX и $wethDYDX через управление dYdX v3 имеют возможность одобрять или отклонять изменения в протоколе обмена.

#### **Исполнитель с правом на длительную блокировку по времени**

Исполнитель с правом на длительную блокировку по времени может исполнять предложения, которые изменяют части протокола dYdX v3, затрагивающие консенсус в отношении управления.

#### **Исполнитель с правом на остановку дерева Меркла**

Исполнитель с правом на остановку дерева Меркла может исполнять предложения, которые замораживают корень дерева Меркла, периодически обновляемый с учетом совокупного баланса наград каждого пользователя. Это позволяет распределять новые награды между пользователями с течением времени в том случае, если предложенный корень неверный или содержит вредоносный код. Он также может запрещать принудительные запросы на торговлю для любого из контрактов доверенности Stark.

Для блокировки по времени заданы следующие исходные параметры:

![Исходные параметры блокировки по времени](../.gitbook/assets/1-initial-timelock-parameters.png)
